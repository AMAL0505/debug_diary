{% extends "user/userbase.html" %}
{% load static %}
{% block content %}


<div class="min-height-200px">
    <div class="row">
        <div class="col-xl-4 col-lg-4 col-md-4 col-sm-12 mb-30">
            <div class="pd-20 card-box height-100-p">
                <div class="profile-photo">
                    <a href="modal" data-toggle="modal" data-target="#modal" class="edit-avatar"><i class="fa fa-pencil"></i></a>
                    <img src="{{userprofile.profile_pic.url}}" alt="" class="avatar-photo" style="width: 160px; height: 160px;">
                    <!-- First Modal: Display Current Profile Picture -->
<!-- First Modal: Display Current Profile Picture -->
<div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-body pd-5">
                <div class="img-container">
                    {% if userprofile.profile_pic %}
                        <img id="image" src="{{ userprofile.profile_pic.url }}" alt="Picture">
                    {% else %}
                        <img id="image" src="{% static 'path/to/default/image.png' %}" alt="Default Picture">
                    {% endif %}
                </div>
            </div>
            {% comment %} <form id="updateProfilePicForm" action="{% url 'updateprofilepic' userprofile.id %}" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#chooseImageModal">Update</button>
                    <button type="submit" class="btn btn-outline-primary">Confirm</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </form> {% endcomment %}
        </div>
    </div>
</div>

<!-- Second Modal: Choose New Profile Picture -->
<div class="modal fade" id="chooseImageModal" tabindex="-1" role="dialog" aria-labelledby="chooseImageModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-body pd-5">
                <h5>Choose a new profile picture</h5>
                <input type="file" id="newProfilePic" accept="image/*">
                <div class="img-preview mt-3" style="display: none;">
                    <img id="newImagePreview" src="" alt="New Picture" style="max-width: 100%;">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="confirmUpdate">Choose</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">OK</button>
            </div>
        </div>
    </div>
</div>
                </div>
                <h5 class="text-center h5 mb-0">{{userprofile.username}}</h5>
                <p class="text-center text-muted font-14">{{userprofile.first_name}} {{userprofile.last_name}}</p>
                <div class="profile-info">
                    <h5 class="mb-20 h5 text-blue">Contact Information</h5>
                    <ul>
                        <li>
                            <span>Email Address:</span>
                            {{userprofile.email}}
                        </li>
                        <li>
                            <span>Phone Number:</span>
                            {{userprofile.ph_no}}
                        </li>
                        
                    </ul>
                </div>
                <div class="profile-social">
                    <h5 class="mb-20 h5 text-blue">Social Links</h5>
                    <ul class="clearfix">
                        <li><a href="#" class="btn" data-bgcolor="#3b5998" data-color="#ffffff"><i class="fa fa-facebook"></i></a></li>
                        <li><a href="#" class="btn" data-bgcolor="#1da1f2" data-color="#ffffff"><i class="fa fa-twitter"></i></a></li>
                        <li><a href="#" class="btn" data-bgcolor="#007bb5" data-color="#ffffff"><i class="fa fa-linkedin"></i></a></li>
                        <li><a href="#" class="btn" data-bgcolor="#f46f30" data-color="#ffffff"><i class="fa fa-instagram"></i></a></li>
                        <li><a href="#" class="btn" data-bgcolor="#c32361" data-color="#ffffff"><i class="fa fa-dribbble"></i></a></li>
                        <li><a href="#" class="btn" data-bgcolor="#3d464d" data-color="#ffffff"><i class="fa fa-dropbox"></i></a></li>
                        <li><a href="#" class="btn" data-bgcolor="#db4437" data-color="#ffffff"><i class="fa fa-google-plus"></i></a></li>
                        <li><a href="#" class="btn" data-bgcolor="#bd081c" data-color="#ffffff"><i class="fa fa-pinterest-p"></i></a></li>
                        <li><a href="#" class="btn" data-bgcolor="#00aff0" data-color="#ffffff"><i class="fa fa-skype"></i></a></li>
                        <li><a href="#" class="btn" data-bgcolor="#00b489" data-color="#ffffff"><i class="fa fa-vine"></i></a></li>
                    </ul>
                </div>
               
            </div>
        </div>
        <div class="col-xl-8 col-lg-8 col-md-8 col-sm-12 mb-30">
            <div class="card-box height-100-p overflow-hidden">
                <div class="profile-tab height-100-p">
                    <div class="tab height-100-p">
                        <ul class="nav nav-tabs customtab" role="tablist">
                           
                            <li class="nav-item">
                                <a class="nav-link" data-toggle="tab" href="#setting" role="tab">Settings</a>
                            </li>
                        </ul>
                        <div class="tab-content">
                            <!-- Timeline Tab start -->
                            
                            <!-- Timeline Tab End -->
                            <!-- Tasks Tab start -->
                           
                            <!-- Tasks Tab End -->
                            <!-- Setting Tab start -->
                            <div class="tab-pane fade height-100-p" id="setting" role="tabpanel">
                                <div class="profile-setting">
                                    <form action="{% url "updateprofile" userprofile.id %}"method="post" enctype="multipart/form-data">
                                        {% csrf_token %}
                                        <ul class="profile-edit-list row">
                                            <li class="weight-500 col-md-8">
                                                <h4 class="text-blue h5 mb-20">Edit Your Personal Setting</h4>
                                                <div class="form-group">
                                                    <label>Username</label>
                                                    <input class="form-control form-control-lg" type="text"name="username" value="{{userprofile.username}}">
                                                </div>
                                                <div class="form-group">
                                                    <label>First Name</label>
                                                    <input class="form-control form-control-lg" type="text"name="first_name" value="{{userprofile.first_name}}">
                                                </div>
                                                <div class="form-group">
                                                    <label>Last Name</label>
                                                    <input class="form-control form-control-lg" type="text" name="last_name" value="{{userprofile.last_name}}">
                                                </div>
                                                <div class="form-group">
                                                    <label>Email</label>
                                                    <input class="form-control form-control-lg" type="email" name="email" value="{{userprofile.email}}">
                                                </div>
                                                
                                             
                                                <div class="form-group">
                                                    <label>Phone Number</label>
                                                    <input class="form-control form-control-lg" type="text" name="ph_no" value="{{userprofile.ph_no}}">
                                                </div>
                                                <div class="form-group">
                                                    <label for="">Profile Picture</label>
                                                    <input class="form-control form-control-lg" type="file" name="profile_pic" value="">
                                                </div>
                                                <div class="form-group mb-0">
                                                    <input type="submit" class="btn btn-primary" value="Update Information">
                                                </div>
                                            </li>
                                            
                                        </ul>
                                    </form>
                                </div>
                            </div>
                            <!-- Setting Tab End -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<script>
    document.getElementById('newProfilePic').addEventListener('change', function(event) {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('newImagePreview').src = e.target.result;
                document.querySelector('.img-preview').style.display = 'block';
            }
            reader.readAsDataURL(file);
        }
    });
    
    document.getElementById('confirmUpdate').addEventListener('click', function() {
        const newImageSrc = document.getElementById('newImagePreview').src;
        document.getElementById('image').src = newImageSrc; // Update the image in the first modal
        $('#chooseImageModal').modal('hide'); // Hide the choose image modal
    });
</script>


{% endblock content%}